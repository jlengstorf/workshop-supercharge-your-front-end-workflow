<!DOCTYPE html><html lang="en"><head><title>app/public/js/source/class.superchargedfacebook</title></head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0"><meta name="groc-relative-root" content="../../../../"><meta name="groc-document-path" content="app/public/js/source/class.superchargedfacebook"><meta name="groc-project-path" content="app/public/js/source/class.superchargedfacebook.js"><meta name="groc-github-url" content="https://github.com/jlengstorf/workshop-supercharge-your-front-end-workflow"><link rel="stylesheet" type="text/css" media="all" href="../../../../assets/style.css"><script type="text/javascript" src="../../../../assets/behavior.js"></script><body><div id="meta"><div class="file-path"><a href="https://github.com/jlengstorf/workshop-supercharge-your-front-end-workflow/blob/master/app/public/js/source/class.superchargedfacebook.js">app/public/js/source/class.superchargedfacebook.js</a></div></div><div id="document"><div class="segment"><div class="comments "><div class="wrapper"><h1 id="classsuperchargedfacebookjs">class.superchargedfacebook.js</h1>
<p>This class loads a given photo album from Facebook and renders photos with 
Mustache templates.</p></div></div><div class="code"><div class="wrapper">(<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> </span>{
<span class="hljs-pi">  'use strict'</span>;</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>The constructor for the <code>SuperchargedFacebook</code> class sets up config data.</p></div></div><div class="code"><div class="wrapper">  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">SuperchargedFacebook</span><span class="hljs-params">( options )</span> </span>{</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><ul>
<li>Call the parent class constructor</li>
</ul></div></div><div class="code"><div class="wrapper">    Supercharged.apply(<span class="hljs-keyword">this</span>, <span class="hljs-built_in">arguments</span>);</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><ul>
<li>Avoid errors with setting options by ensuring there&#39;s an object</li>
</ul></div></div><div class="code"><div class="wrapper">    <span class="hljs-keyword">var</span> opts = options || {};</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><ul>
<li>Load the token and album ID from the <code>options</code> hash</li>
</ul></div></div><div class="code"><div class="wrapper">    <span class="hljs-keyword">this</span>.token = opts.token || <span class="hljs-literal">false</span>;
    <span class="hljs-keyword">this</span>.albumID = opts.albumID || <span class="hljs-literal">false</span>;</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><ul>
<li>If the token and/or album ID is missing, don&#39;t bother continuing</li>
</ul></div></div><div class="code"><div class="wrapper">    <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">this</span>.token || !<span class="hljs-keyword">this</span>.albumID) {
      <span class="hljs-keyword">this</span>.log(<span class="hljs-string">'A valid token and album ID are required.'</span>);
      <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
    }</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><ul>
<li>Set the URL for the API</li>
</ul></div></div><div class="code"><div class="wrapper">    <span class="hljs-keyword">this</span>.api = <span class="hljs-string">'https://graph.facebook.com/v2.3/'</span>;

  }</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>Create an object that extends the <code>Supercharged</code> class.</p></div></div><div class="code"><div class="wrapper">  SuperchargedFacebook.prototype = <span class="hljs-built_in">Object</span>.create(Supercharged.prototype, {
    constructor: {
      value: SuperchargedFacebook
    }
  });</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>Create a request for the specified album&#39;s photos</p></div></div><div class="code"><div class="wrapper">  SuperchargedFacebook.prototype.loadRecentMedia = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(  )</span> </span>{

    <span class="hljs-keyword">var</span> self = <span class="hljs-keyword">this</span>,</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><ul>
<li>Determine the proper API endpoint</li>
</ul></div></div><div class="code"><div class="wrapper">        endpoint = self.api + self.albumID + <span class="hljs-string">'/photos'</span>,</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><ul>
<li>Attach the access token to avoid errors</li>
</ul></div></div><div class="code"><div class="wrapper">        url = endpoint + <span class="hljs-string">'?access_token='</span> + self.token;</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><ul>
<li>Use JSONP to load the data and process it with the <code>handleJSON</code> method</li>
</ul></div></div><div class="code"><div class="wrapper">    self.loadJSONP(url, self.handleJSON.bind(self));

  };</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>Handles the sorting of Facebook&#39;s JSON response</p></div></div><div class="code"><div class="wrapper">  SuperchargedFacebook.prototype.handleJSON = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( response )</span> </span>{</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><ul>
<li>Make the <code>this</code> accessible inside the <code>forEach</code> loop</li>
</ul></div></div><div class="code"><div class="wrapper">    <span class="hljs-keyword">var</span> self = <span class="hljs-keyword">this</span>,
        templateVars = {},
        count = <span class="hljs-number">0</span>;

    self.log(<span class="hljs-string">'Data received:'</span>, response);</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><ul>
<li>Make sure the response contains valid data</li>
</ul></div></div><div class="code"><div class="wrapper">    <span class="hljs-keyword">if</span> (response.hasOwnProperty(<span class="hljs-string">'data'</span>) &amp;&amp; response.data.length&gt;<span class="hljs-number">0</span>) {</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><ul>
<li>Create an empty object to store photos</li>
</ul></div></div><div class="code"><div class="wrapper">      templateVars.photos = [];</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><ul>
<li>Loop through each item in the returned media</li>
</ul></div></div><div class="code"><div class="wrapper">      response.data.forEach(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">( media, index )</span> </span>{

        <span class="hljs-keyword">if</span> (count&gt;=self.photosToDisplay) {
          <span class="hljs-keyword">return</span>;
        }</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><ul>
<li>Add info about the image to the photos object</li>
</ul></div></div><div class="code"><div class="wrapper">        templateVars.photos[count++] = {
          imgSrc: media.picture,
          link: media.link,
          caption: <span class="hljs-string">'Image from Facebook'</span>
        };

      });</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><ul>
<li>Render the output using a Mustache template</li>
</ul></div></div><div class="code"><div class="wrapper">      self.renderTemplate(self.template, templateVars, self.addToDOM.bind(self));

    }

  };</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>Make the SuperchargedFacebook class available to the global scope</p></div></div><div class="code"><div class="wrapper">  <span class="hljs-built_in">window</span>.SuperchargedFacebook = SuperchargedFacebook;

}).call();</div></div></div></div></body></html>